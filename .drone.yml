---
kind: pipeline
type: docker
name: greeting

steps:
- name: env
  image: alpine:3.8
  environment:
    USERNAME:
      from_secret: username
    PASSWORD:
      from_secret: password
  commands:
  - echo "the username is $${USERNAME}"
  - echo "and the password is $${PASSWORD}"

- name: Run Test Script
  image: alpine:3.8
  environment:
    USERNAME:
      from_secret: username
    PASSWORD:
      from_secret: password
  commands:
    - chmod +x ./send_mail.sh
    - ./send_mail.sh

---
kind: secret
name: username
get:
  path: secret/data/docker
  name: username

---
kind: secret
name: password
get:
  path: secret/data/docker
  name: password
